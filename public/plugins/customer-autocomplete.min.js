function customer_autocomplete(e, t) {
  let n;
  function o(e) {
    if (!e) return !1;
    !(function (e) {
      for (var t = 0; t < e.length; t++) e[t].classList.remove("active");
    })(e),
      n >= e.length && (n = 0),
      n < 0 && (n = e.length - 1),
      e[n].classList.add("active");
  }
  function d(t) {
    for (
      var n = document.getElementsByClassName("autocomplete-items"), o = 0;
      o < n.length;
      o++
    )
      t != n[o] && t != e && n[o].parentNode.removeChild(n[o]);
  }
  document
    .getElementById("customer-autocomplete")
    .classList.add("list-group", "position-relative"),
    e.addEventListener("input", function (e) {
      let o,
        a,
        i,
        s = this.value;
      if ((d(), !s)) return !1;
      (n = -1),
        (o = document.createElement("div")).classList.add(
          "autocomplete-items",
          "bg-light",
          "position-absolute",
          "border",
          "mt-1",
          "w-100",
          "rounded",
          "shadow-sm"
        ),
        (o.style.top = "100%"),
        (o.style.zIndex = 99),
        this.parentNode.appendChild(o);
      let l = document.createElement("div");
      for (
        l.innerHTML =
          '<button class="btn btn-outline-dark btn-block" data-toggle="modal" data-target="#add-customer-modal">+ Add customer</button>',
          i = 0;
        i < t.length;
        i++
      )
        t[i].substr(0, s.length).toUpperCase() == s.toUpperCase()
          ? ((a = document.createElement("li")).classList.add(
              "list-group-item",
              "border-0"
            ),
            (a.innerHTML = t[i].substr(0, s.length)),
            (a.innerHTML += "<strong>" + t[i].substr(s.length) + "</strong>"),
            (a.innerHTML += '<input type="hidden" value="' + t[i] + '">'),
            a.addEventListener("click", function (e) {
              (app.customerName = this.getElementsByTagName("input")[0].value),
                d();
            }),
            o.appendChild(a),
            o.appendChild(l))
          : o.appendChild(l);
    }),
    e.addEventListener("keydown", function (e) {
      var t = document.getElementById(this.id);
      t && (t = t.getElementsByTagName("div")),
        40 == e.keyCode
          ? (n++, o(t))
          : 38 == e.keyCode
          ? (n--, o(t))
          : 13 == e.keyCode &&
            (e.preventDefault(), n > -1 && t && t[n].click());
    }),
    document.addEventListener("click", function (e) {
      d(e.target);
    });
}
